/*
 * This file contains utility functions that can be imported and used in
 * other modules.
 */

@use "../user.config" as user;
@use "sass:selector";
@use "sass:string";
@use "sass:list";

@mixin add-pseudo-classes($selector, $classes...) {
  // Adds pseudo classes to a given selector.
  @content;
  @each $class in $classes {
    @if string.slice(#{list.nth($selector, 1)}, 1, 1) == "." {
      @at-root .#{$class}\:#{selector.append(string.slice(#{list.nth($selector, 1)}, 2, -1), ":" + $class)} {
        @content;
      }
    } @else {
      @at-root .#{$class}\:#{selector.append($selector, ":" + $class)} {
        @content;
      }
    }
  }
}

@mixin add-breakpoints($selector) {
  // Adds breakpoints to a given selector.
  @content;
  @each $label, $breakpoint in user.$breakpoints {
    @if string.slice(#{list.nth($selector, 1)}, 1, 1) == "." {
      @at-root .#{$label}\:#{string.slice(#{list.nth($selector, 1)}, 2, -1)} {
        @media screen and (min-width: $breakpoint) {
          @content;
        }
      }
    } @else {
      @at-root .#{$label}\:#{$selector} {
        @media screen and (min-width: $breakpoint) {
          @content;
        }
      }
    }
  }
}

@mixin add-pseudo-classes-with-breakpoints($selector, $classes...) {
  // Adds pseudo-classes at each breakpoint to a given selector.
  @include add-pseudo-classes($selector, $classes...) {
    @content;
  }
  @each $label, $breakpoint in user.$breakpoints {
    @if string.slice(#{list.nth($selector, 1)}, 1, 1) == "." {
      @at-root .#{$label}\:#{string.slice(#{list.nth($selector, 1)}, 2, -1)} {
        @media screen and (min-width: $breakpoint) {
          @content;
          @each $class in $classes {
            @at-root .#{$label}\:#{$class}\:#{selector.append(string.slice(#{list.nth($selector, 1)}, 2, -1), ":" + $class)} {
              @content;
            }
          }
        }
      }
    } @else {
      @at-root .#{$label}\:#{$selector} {
        @media screen and (min-width: $breakpoint) {
          @content;
          @each $class in $classes {
            @at-root .#{$label}\:#{$class}\:#{selector.append($selector, ":" + $class)} {
              @content;
            }
          }
        }
      }
    }
  }
}
